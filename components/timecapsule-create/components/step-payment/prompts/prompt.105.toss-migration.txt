ì•„ë˜ì˜ ì¡°ê±´ì„ ëª¨ë‘ ì ìš©í•˜ì—¬, ì•„ë˜ì˜ ìš”êµ¬ì‚¬í•­ì„ ëª¨ë‘ êµ¬í˜„í•  ê²ƒ.
êµ¬í˜„ ê²°ê³¼ë¥¼ ì²´í¬ë¦¬ìŠ¤íŠ¸ë¡œ ë°˜í™˜í•  ê²ƒ.

==============================================

ì¡°ê±´-ì»¤ì„œë£°) ì•„ë˜ì˜ ì»¤ì„œë£°ì„ ì ìš©í•˜ì—¬ ì‘ì—…í•˜ê³ , ì´ ì‘ì—…ì´ ëë‚˜ë©´ í•´ë‹¹ rules ì ìš© ê²°ê³¼ë¥¼ ì²´í¬ë¦¬ìŠ¤íŠ¸ë¡œ ë°˜í™˜í•  ê²ƒ.
            - @.cursor/rules/01-common.mdc
            - @.cursor/rules/04-func.mdc

==============================================

ì¡°ê±´-íŒŒì¼ê²½ë¡œ) ìˆ˜ì •í•  íŒŒì¼ë“¤:
            - components/timecapsule-create/components/step-payment/index.tsx
            - components/timecapsule-create/components/step-payment/types.ts
            - components/timecapsule-create/components/step-payment/api/payment.ts
            - components/timecapsule-create/components/step-payment/api/types/payment.ts
            - components/timecapsule-create/components/step-payment/hooks/useKakaoPayment.ts (â†’ useTossPayment.tsë¡œ ë³€ê²½)

==============================================

í•µì‹¬ìš”êµ¬ì‚¬í•­) ì¹´ì¹´ì˜¤í˜ì´ â†’ í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ì—°ë™ ë§ˆì´ê·¸ë ˆì´ì…˜

ë°°ê²½:
- ë°±ì—”ë“œê°€ ì¹´ì¹´ì˜¤í˜ì´ API ì§€ì› ì¤‘ë‹¨
- í† ìŠ¤í˜ì´ë¨¼ì¸  APIë¡œ ì „í™˜ í•„ìš”
- ê¸°ì¡´ UI êµ¬ì¡° ë° ì‚¬ìš©ì í”Œë¡œìš°ëŠ” ìµœëŒ€í•œ ìœ ì§€

ì‘ì—… ë°©ì‹:
- ê¸°ì¡´ ì¹´ì¹´ì˜¤í˜ì´ ê´€ë ¨ ì½”ë“œë¥¼ ëª¨ë‘ í† ìŠ¤í˜ì´ë¨¼ì¸ ë¡œ ë³€ê²½
- ê¸°ì¡´ UI êµ¬ì¡°(index.tsx, styles.ts)ëŠ” ìµœì†Œí•œìœ¼ë¡œ ìˆ˜ì •
- API ë° hook íŒŒì¼ì„ í† ìŠ¤í˜ì´ë¨¼ì¸  ìŠ¤í™ì— ë§ê²Œ ìˆ˜ì •

==============================================

ë°±ì—”ë“œ API ìŠ¤í™ (ì™„ì „íŒ)

ì¤‘ìš” ë³€ê²½ì‚¬í•­:
- ì¹´ì¹´ì˜¤í˜ì´ì˜ "ê²°ì œ ì¤€ë¹„(ready) â†’ ìŠ¹ì¸(approve)" 2ë‹¨ê³„ í”Œë¡œìš°ê°€ ì‚¬ë¼ì§
- í† ìŠ¤í˜ì´ë¨¼ì¸ ëŠ” í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì§ì ‘ SDKë¡œ ê²°ì œ ìš”ì²­
- ë°±ì—”ë“œëŠ” ê²°ì œ ì™„ë£Œ í›„ ìŠ¹ì¸(confirm) APIë§Œ ì œê³µ
- ë¦¬ë‹¤ì´ë ‰íŠ¸ URLì€ ë°±ì—”ë“œê°€ ì•„ë‹Œ í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì„¤ì • (successUrl, failUrl)
- ì‹¤ì—°ë™ ëª¨ë“œ(TOSS_PAY_ENABLE=true)ì™€ í…ŒìŠ¤íŠ¸ ëª¨ë“œ(ëª¨í‚¹) ì§€ì›

1. ê²°ì œ ìŠ¹ì¸ API (POST /api/payments/toss/confirm)
   
   ë™ì‘ ë°©ì‹:
   - ì‚¬ìš©ìê°€ í† ìŠ¤ ê²°ì œ ì™„ë£Œ í›„ ì „ë‹¬ë°›ì€ paymentKey, orderId, amountë¥¼ JWTì™€ í•¨ê»˜ ì „ì†¡
   - ì„œë²„ëŠ” ì£¼ë¬¸ ì¡´ì¬ ì—¬ë¶€, ì£¼ë¬¸ì ì¼ì¹˜, ê²°ì œ ìƒíƒœ(PAID ì•„ë‹˜), ìƒí’ˆ íƒ€ì…(TIME_CAPSULE), ê¸ˆì•¡ ì¼ì¹˜ ê²€ì¦
   - ì‹¤ì—°ë™(TOSS_PAY_ENABLE=true)ì´ë©´ TOSS_SECRET_KEYë¡œ í† ìŠ¤ v1/payments/confirm í˜¸ì¶œ
   - í…ŒìŠ¤íŠ¸ ëª¨ë“œì—ì„œëŠ” ëª¨í‚¹ ì‘ë‹µ ìƒì„±
   - ê²°ì œ ì™„ë£Œ í›„ íƒ€ì„ìº¡ìŠ ìƒì„±
   
   ìš”ì²­:
   - Method: POST
   - URL: /api/payments/toss/confirm
   - Headers: { Authorization: "Bearer {JWT}" }
   - Body: {
       paymentKey: string,  // 1~200ì
       orderId: string,     // 6~200ì
       amount: number       // ê²°ì œ ê¸ˆì•¡
     }
   
   ì‘ë‹µ (201 Created):
   {
     order_id: string,
     payment_key: string,
     status: string,        // "PAID"
     amount: number,
     approved_at: string,   // ISO 8601 í˜•ì‹
     capsule_id: string,    // ìƒì„±ëœ íƒ€ì„ìº¡ìŠ UUID
     receipt_url: string
   }
   
   ì—ëŸ¬ ì‘ë‹µ:
   - 400 AMOUNT_MISMATCH: ê²°ì œ ê¸ˆì•¡ì´ ì£¼ë¬¸ ê¸ˆì•¡ê³¼ ë¶ˆì¼ì¹˜
   - 400 ORDER_ALREADY_PAID: ì´ë¯¸ ê²°ì œ ì™„ë£Œëœ ì£¼ë¬¸
   - 400 TOSS_SECRET_KEY_REQUIRED: ì‹¤ì—°ë™ ëª¨ë“œì¸ë° ì‹œí¬ë¦¿ í‚¤ ì—†ìŒ
   - 400 TOSS_CONFIRM_FAILED: í† ìŠ¤ API í˜¸ì¶œ ì‹¤íŒ¨ (í† ìŠ¤ ì‘ë‹µ ë©”ì‹œì§€ í¬í•¨)
   - 401 ORDER_NOT_OWNED: ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ì£¼ë¬¸
   - 401 Unauthorized: JWT ëˆ„ë½/ë§Œë£Œ
   - 404 ORDER_NOT_FOUND: ì£¼ë¬¸ ì •ë³´ ì—†ìŒ
   - 404 PRODUCT_NOT_FOUND_OR_INVALID: ìƒí’ˆì´ TIME_CAPSULEì´ ì•„ë‹˜

2. ê²°ì œ ì¡°íšŒ API - paymentKey (GET /api/payments/toss/{paymentKey})
   
   ë™ì‘ ë°©ì‹:
   - ë‚´ë¶€ DBì—ì„œë§Œ ì¡°íšŒ (í† ìŠ¤ API í˜¸ì¶œ ì—†ìŒ)
   - Payment í…Œì´ë¸”ì—ì„œ paymentKeyë¡œ ê²€ìƒ‰
   - ì·¨ì†Œ ì´ë ¥(payment_cancels) í•¨ê»˜ ë¡œë“œ
   
   ìš”ì²­:
   - Method: GET
   - URL: /api/payments/toss/{paymentKey}
   - Headers: { Authorization: "Bearer {JWT}" }
   - Path Param: paymentKey (string)
   
   ì‘ë‹µ (200 OK):
   {
     payment: {
       paymentKey: string,
       orderNo: string,
       tossStatus: string,        // "DONE", "CANCELED" ë“±
       method: string,             // "ì¹´ë“œ" ë“±
       currency: string,           // "KRW"
       amount: number,             // balance_amount (ì”ì•¡)
       approvedAt: string,         // ISO 8601
       receiptUrl: string
     },
     cancels: [
       {
         transactionKey: string,
         cancelAmount: number,
         cancelReason: string,
         cancelStatus: string,
         canceledAt: string
       }
     ]
   }
   
   ì—ëŸ¬ ì‘ë‹µ:
   - 401 Unauthorized: JWT ëˆ„ë½/ë§Œë£Œ
   - 404 PAYMENT_NOT_FOUND: ê²°ì œ ì •ë³´ ì—†ìŒ

3. ê²°ì œ ì¡°íšŒ API - orderNo (GET /api/payments/toss/orders/{orderNo})
   
   ë™ì‘ ë°©ì‹:
   - ë‚´ë¶€ DBì—ì„œë§Œ ì¡°íšŒ (í† ìŠ¤ API í˜¸ì¶œ ì—†ìŒ)
   - Payment í…Œì´ë¸”ì—ì„œ orderNoë¡œ ê²€ìƒ‰
   - ì·¨ì†Œ ì´ë ¥(payment_cancels) í•¨ê»˜ ë¡œë“œ
   
   ìš”ì²­:
   - Method: GET
   - URL: /api/payments/toss/orders/{orderNo}
   - Headers: { Authorization: "Bearer {JWT}" }
   - Path Param: orderNo (string)
   
   ì‘ë‹µ (200 OK):
   {
     payment: {
       paymentKey: string,
       orderNo: string,
       tossStatus: string,
       method: string,
       currency: string,
       amount: number,
       approvedAt: string,
       receiptUrl: string
     },
     cancels: [...]
   }
   
   ì—ëŸ¬ ì‘ë‹µ:
   - 401 Unauthorized: JWT ëˆ„ë½/ë§Œë£Œ
   - 404 PAYMENT_NOT_FOUND: ê²°ì œ ì •ë³´ ì—†ìŒ

4. ê²°ì œ ì·¨ì†Œ API (POST /api/payments/toss/{paymentKey}/cancel)
   
   ë™ì‘ ë°©ì‹:
   - paymentKeyë¡œ ê²°ì œ ì¡°íšŒ í›„ ì£¼ë¬¸ ì†Œìœ ì í™•ì¸
   - ì‹¤ì—°ë™(TOSS_PAY_ENABLE=true)ì´ë©´ TOSS_SECRET_KEYë¡œ í† ìŠ¤ v1/payments/{paymentKey}/cancel í˜¸ì¶œ
   - í…ŒìŠ¤íŠ¸ ëª¨ë“œì—ì„œëŠ” ëª¨í‚¹ ì‘ë‹µ ìƒì„±
   - ë¶€ë¶„ ì·¨ì†Œ/ì „ì•¡ ì·¨ì†Œ ëª¨ë‘ ì§€ì›
   - ì”ì•¡ì´ 0ì´ê±°ë‚˜ í† ìŠ¤ ì‘ë‹µ statusê°€ CANCELEDì´ë©´ ë‚´ë¶€ ìƒíƒœë„ CANCELEDë¡œ ë³€ê²½
   - ì·¨ì†Œ ì´ë ¥ì„ PaymentCancel í…Œì´ë¸”ì— ì €ì¥ (ì¤‘ë³µ transactionKeyëŠ” ì €ì¥ ì•ˆ í•¨)
   
   ìš”ì²­:
   - Method: POST
   - URL: /api/payments/toss/{paymentKey}/cancel
   - Headers: { Authorization: "Bearer {JWT}" }
   - Path Param: paymentKey (1~200ì)
   - Body: {
       cancelReason: string,              // í•„ìˆ˜, 1~200ì
       cancelAmount?: number,             // ì„ íƒ (ì—†ìœ¼ë©´ ì „ì•¡ ì·¨ì†Œ)
       refundReceiveAccount?: {           // ì„ íƒ (ê°€ìƒê³„ì¢Œ í™˜ë¶ˆìš©)
         bank: string,
         accountNumber: string,
         holderName: string
       }
     }
   
   ì‘ë‹µ (200 OK):
   {
     payment_key: string,
     status: string,              // "CANCELED" ë˜ëŠ” "DONE" (ë¶€ë¶„ ì·¨ì†Œ ì‹œ)
     balance_amount: number,      // ì”ì•¡
     cancels: [
       {
         transactionKey: string,
         cancelAmount: number,
         cancelReason: string,
         cancelStatus: string,
         canceledAt: string
       }
     ],
     receipt_url: string
   }
   
   ì—ëŸ¬ ì‘ë‹µ:
   - 400 TOSS_SECRET_KEY_REQUIRED: ì‹¤ì—°ë™ ëª¨ë“œì¸ë° ì‹œí¬ë¦¿ í‚¤ ì—†ìŒ
   - 400 TOSS_CANCEL_FAILED: í† ìŠ¤ API í˜¸ì¶œ ì‹¤íŒ¨ (í† ìŠ¤ ì‘ë‹µ ë©”ì‹œì§€ í¬í•¨)
   - 401 ORDER_NOT_OWNED: ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ê²°ì œ
   - 401 Unauthorized: JWT ëˆ„ë½/ë§Œë£Œ
   - 404 PAYMENT_NOT_FOUND: ê²°ì œ ì •ë³´ ì—†ìŒ

í™˜ê²½ ë³€ìˆ˜ ì„¤ì •:
- TOSS_PAY_ENABLE: "true"ì´ë©´ ì‹¤ì—°ë™, ê·¸ ì™¸ëŠ” í…ŒìŠ¤íŠ¸ ëª¨ë“œ(ëª¨í‚¹)
- TOSS_SECRET_KEY: ì‹¤ì—°ë™ ì‹œ í•„ìˆ˜ (Basic ì¸ì¦ìš©)
- TOSS_BASE_URL: ê¸°ë³¸ê°’ https://api.tosspayments.com (ì„ íƒì‚¬í•­)

==============================================

í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ í”Œë¡œìš° (ìƒˆë¡œìš´ ë°©ì‹)

[ê¸°ì¡´ - ì¹´ì¹´ì˜¤í˜ì´]
1. í”„ë¡ íŠ¸ â†’ ë°±ì—”ë“œ: POST /api/payments/kakao/ready (ê²°ì œ ì¤€ë¹„)
2. ë°±ì—”ë“œ â†’ í”„ë¡ íŠ¸: redirect_url ë°˜í™˜
3. í”„ë¡ íŠ¸: expo-web-browserë¡œ ì¹´ì¹´ì˜¤í˜ì´ ê²°ì œ í˜ì´ì§€ ì—´ê¸°
4. ì‚¬ìš©ì: ê²°ì œ ì™„ë£Œ â†’ pg_tokenê³¼ í•¨ê»˜ ì•±ìœ¼ë¡œ ë³µê·€
5. í”„ë¡ íŠ¸ â†’ ë°±ì—”ë“œ: POST /api/payments/kakao/approve (ê²°ì œ ìŠ¹ì¸)

[ë³€ê²½ - í† ìŠ¤í˜ì´ë¨¼ì¸ ]
1. í”„ë¡ íŠ¸: Toss Payments SDK ì´ˆê¸°í™” (í´ë¼ì´ì–¸íŠ¸ í‚¤ ì‚¬ìš©)
2. í”„ë¡ íŠ¸: SDK.requestPayment() í˜¸ì¶œ â†’ í† ìŠ¤ ê²°ì œ í˜ì´ì§€ í‘œì‹œ
3. ì‚¬ìš©ì: ê²°ì œ ì™„ë£Œ â†’ paymentKey, orderId, amountì™€ í•¨ê»˜ ì•±ìœ¼ë¡œ ë³µê·€ (successUrl)
4. í”„ë¡ íŠ¸ â†’ ë°±ì—”ë“œ: POST /api/payments/toss/confirm (ê²°ì œ ìŠ¹ì¸)
5. ë°±ì—”ë“œ: í† ìŠ¤ APIë¡œ ìŠ¹ì¸ ì²˜ë¦¬ í›„ ê²°ì œ ì •ë³´ ì €ì¥
6. (ì„ íƒ) í”„ë¡ íŠ¸ â†’ ë°±ì—”ë“œ: GET /api/payments/toss/{paymentKey} (ê²°ì œ ì¡°íšŒ)

==============================================

ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¡°ê±´

1. íŒ¨í‚¤ì§€ ì„¤ì¹˜
   - npm install @tosspayments/payment-sdk-react-native
   - React Native ì „ìš© SDK ì‚¬ìš© (ì›¹ SDK ì•„ë‹˜)

2. ê¸°ì¡´ íŒ¨í‚¤ì§€ ì œê±° (ì„ íƒì‚¬í•­)
   - expo-web-browserëŠ” ë‹¤ë¥¸ ê¸°ëŠ¥ì—ì„œ ì‚¬ìš© ì¤‘ì´ë©´ ìœ ì§€

3. ì‚¬ìš©í•  ë¼ì´ë¸ŒëŸ¬ë¦¬
   - HTTP í´ë¼ì´ì–¸íŠ¸: axios (ê¸°ì¡´ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš© ì¤‘)
   - ìƒíƒœê´€ë¦¬: React hooks (useState, useCallback, useMemo)
   - ì•Œë¦¼: React Nativeì˜ Alert
   - ê²°ì œ ì—°ë™: @tosspayments/payment-sdk-react-native

==============================================

ìœ ì € ì‹œë‚˜ë¦¬ì˜¤

1) ê²°ì œí•˜ê¸° ë²„íŠ¼ í´ë¦­
   1. ì‚¬ìš©ìê°€ ëª¨ë“  ì•½ê´€ì— ë™ì˜í•˜ê³  "í† ìŠ¤í˜ì´ë¨¼ì¸ ë¡œ ê²°ì œí•˜ê¸°" ë²„íŠ¼ í´ë¦­
   2. ë¡œë”© ìƒíƒœ í‘œì‹œ ì‹œì‘
   3. Toss Payments SDK í˜¸ì¶œ
      - orderId: orderData.order_id
      - amount: orderSummary.totalPrice
      - orderName: "íƒ€ì„ìº¡ìŠ ìƒì„±"
      - customerName: formDataì—ì„œ ê°€ì ¸ì˜¤ê¸° (ë˜ëŠ” "ê³ ê°")
      - successUrl: "myapp://pay/toss/success"
      - failUrl: "myapp://pay/toss/fail"
   4. SDKê°€ í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ í˜ì´ì§€ í‘œì‹œ
   5. ì‚¬ìš©ìê°€ ê²°ì œ ì™„ë£Œí•˜ë©´ successUrlë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
      - URL íŒŒë¼ë¯¸í„°: paymentKey, orderId, amount
   6. ì‹¤íŒ¨ ì‹œ:
      - ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ (Alert)
      - ë¡œë”© ìƒíƒœ ì¢…ë£Œ

2) í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ì™„ë£Œ í›„ ë³µê·€ (successUrl)
   1. ì‚¬ìš©ìê°€ í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œë¥¼ ì™„ë£Œí•˜ë©´ ì•±ìœ¼ë¡œ ë³µê·€
   2. URLì—ì„œ paymentKey, orderId, amount íŒŒë¼ë¯¸í„° ì¶”ì¶œ
   3. POST /api/payments/toss/confirm API í˜¸ì¶œ
      - paymentKey, orderId, amount ì „ë‹¬
   4. ì„±ê³µ ì‹œ:
      - ê²°ì œ ì™„ë£Œ ëª¨ë‹¬ í‘œì‹œ (ConfirmModal - PAYMENT_COMPLETE)
      - ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ë¡œ ê²°ì œ ì„±ê³µ ì´ë²¤íŠ¸ ì „ë‹¬ (onPaymentSuccess ì½œë°±)
      - íƒ€ì„ìº¡ìŠ ìƒì„± ì™„ë£Œ í™”ë©´ìœ¼ë¡œ ì´ë™
   5. ì‹¤íŒ¨ ì‹œ:
      - ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ (Alert)
      - ê²°ì œ í™”ë©´ìœ¼ë¡œ ë³µê·€

3) ê²°ì œ ì·¨ì†Œ/ì‹¤íŒ¨ (failUrl)
   1. ì‚¬ìš©ìê°€ í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œë¥¼ ì·¨ì†Œí•˜ê±°ë‚˜ ì‹¤íŒ¨í•˜ë©´ ì•±ìœ¼ë¡œ ë³µê·€
   2. URLì—ì„œ code, message íŒŒë¼ë¯¸í„° ì¶”ì¶œ
   3. ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ (Alert)
   4. ê²°ì œ í™”ë©´ ìœ ì§€ (ì¬ì‹œë„ ê°€ëŠ¥)

==============================================

ì—ëŸ¬ ì²˜ë¦¬

1) ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ (status === 0)
   - "ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”" ë©”ì‹œì§€ í‘œì‹œ
   - ì¬ì‹œë„ ê°€ëŠ¥ ìƒíƒœ ìœ ì§€

2) 400 ì—ëŸ¬ (ì˜ëª»ëœ ìš”ì²­)
   ê²°ì œ ìŠ¹ì¸ API:
   - AMOUNT_MISMATCH: "ê²°ì œ ê¸ˆì•¡ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤"
   - ORDER_ALREADY_PAID: "ì´ë¯¸ ê²°ì œê°€ ì™„ë£Œëœ ì£¼ë¬¸ì…ë‹ˆë‹¤"
   - TOSS_SECRET_KEY_REQUIRED: "ê²°ì œ ì‹œìŠ¤í…œ ì„¤ì • ì˜¤ë¥˜ì…ë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•´ì£¼ì„¸ìš”"
   - TOSS_CONFIRM_FAILED: "ê²°ì œ ìŠ¹ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: {í† ìŠ¤ ì‘ë‹µ ë©”ì‹œì§€}"
   
   ê²°ì œ ì·¨ì†Œ API:
   - TOSS_SECRET_KEY_REQUIRED: "ê²°ì œ ì‹œìŠ¤í…œ ì„¤ì • ì˜¤ë¥˜ì…ë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•´ì£¼ì„¸ìš”"
   - TOSS_CANCEL_FAILED: "ê²°ì œ ì·¨ì†Œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: {í† ìŠ¤ ì‘ë‹µ ë©”ì‹œì§€}"
   
   ê¸°íƒ€: ë°±ì—”ë“œ ë©”ì‹œì§€ ê·¸ëŒ€ë¡œ í‘œì‹œ

3) 401 ì—ëŸ¬ (ì¸ì¦ ì˜¤ë¥˜)
   - ORDER_NOT_OWNED: "ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ì£¼ë¬¸/ê²°ì œì…ë‹ˆë‹¤"
   - Unauthorized (JWT ëˆ„ë½/ë§Œë£Œ): "ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤"
   - ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ ì´ë™ (ì„ íƒì‚¬í•­)

4) 404 ì—ëŸ¬ (ë¦¬ì†ŒìŠ¤ ë¯¸ì¡´ì¬)
   ê²°ì œ ìŠ¹ì¸ API:
   - ORDER_NOT_FOUND: "ì£¼ë¬¸ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
   - PRODUCT_NOT_FOUND_OR_INVALID: "ìƒí’ˆ ì •ë³´ê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤"
   
   ê²°ì œ ì¡°íšŒ/ì·¨ì†Œ API:
   - PAYMENT_NOT_FOUND: "ê²°ì œ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
   
   ì´ì „ í™”ë©´ìœ¼ë¡œ ì´ë™ (ì„ íƒì‚¬í•­)

5) 500 ì—ëŸ¬ (ì„œë²„ ì˜¤ë¥˜)
   - "ì¼ì‹œì ì¸ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”"

ì£¼ì˜ì‚¬í•­:
- TOSS_SECRET_KEY_REQUIRED, TOSS_CONFIRM_FAILED, TOSS_CANCEL_FAILEDëŠ” 400 ì—ëŸ¬ë¡œ ë°˜í™˜ë¨ (500 ì•„ë‹˜)
- ì—ëŸ¬ ì½”ë“œëŠ” response.data.codeì— í¬í•¨ë¨
- í† ìŠ¤ API ì‹¤íŒ¨ ì‹œ í† ìŠ¤ì˜ ì‘ë‹µ ë©”ì‹œì§€ë„ í•¨ê»˜ í‘œì‹œ

==============================================

êµ¬í˜„ ê°€ì´ë“œë¼ì¸

1. API Types íŒŒì¼ ìˆ˜ì •
   íŒŒì¼: components/timecapsule-create/components/step-payment/api/types/payment.ts
   
   [ì œê±°] ê¸°ì¡´ ì¹´ì¹´ì˜¤í˜ì´ íƒ€ì…
   ```typescript
   export interface KakaoPayReadyRequest { ... }
   export interface KakaoPayReadyResponse { ... }
   export interface KakaoPayApproveRequest { ... }
   export interface KakaoPayApproveResponse { ... }
   ```
   
   [ì¶”ê°€] í† ìŠ¤í˜ì´ë¨¼ì¸  íƒ€ì…
   ```typescript
   /**
    * í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ìŠ¹ì¸ ìš”ì²­
    */
   export interface TossPaymentConfirmRequest {
     /** ê²°ì œ í‚¤ (1~200ì) */
     paymentKey: string;
     /** ì£¼ë¬¸ ID (6~200ì) */
     orderId: string;
     /** ê²°ì œ ê¸ˆì•¡ */
     amount: number;
   }
   
   /**
    * í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ìŠ¹ì¸ ì‘ë‹µ
    */
   export interface TossPaymentConfirmResponse {
     /** ì£¼ë¬¸ ID */
     order_id: string;
     /** ê²°ì œ í‚¤ */
     payment_key: string;
     /** ê²°ì œ ìƒíƒœ (ì˜ˆ: "PAID") */
     status: string;
     /** ê²°ì œ ê¸ˆì•¡ */
     amount: number;
     /** ìŠ¹ì¸ ì¼ì‹œ (ISO 8601) */
     approved_at: string;
     /** íƒ€ì„ìº¡ìŠ ID */
     capsule_id: string;
     /** ì˜ìˆ˜ì¦ URL */
     receipt_url: string;
   }
   
   /**
    * í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ì¡°íšŒ ì‘ë‹µ (ì„ íƒì‚¬í•­)
    * GET /api/payments/toss/{paymentKey} ë˜ëŠ” /api/payments/toss/orders/{orderNo}
    */
   export interface TossPaymentResponse {
     payment: {
       paymentKey: string;
       orderNo: string;
       tossStatus: string;        // "DONE", "CANCELED" ë“±
       method: string;             // "ì¹´ë“œ" ë“±
       currency: string;           // "KRW"
       amount: number;             // balance_amount (ì”ì•¡)
       approvedAt: string;         // ISO 8601
       receiptUrl: string;
     };
     cancels: Array<{
       transactionKey: string;
       cancelAmount: number;
       cancelReason: string;
       cancelStatus: string;
       canceledAt: string;
     }>;
   }
   
   /**
    * í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ì·¨ì†Œ ìš”ì²­ (ì„ íƒì‚¬í•­)
    * POST /api/payments/toss/{paymentKey}/cancel
    */
   export interface TossPaymentCancelRequest {
     /** ì·¨ì†Œ ì‚¬ìœ  (1~200ì, í•„ìˆ˜) */
     cancelReason: string;
     /** ì·¨ì†Œ ê¸ˆì•¡ (ì„ íƒ, ì—†ìœ¼ë©´ ì „ì•¡ ì·¨ì†Œ) */
     cancelAmount?: number;
     /** í™˜ë¶ˆ ê³„ì¢Œ ì •ë³´ (ì„ íƒ, ê°€ìƒê³„ì¢Œ í™˜ë¶ˆìš©) */
     refundReceiveAccount?: {
       bank: string;
       accountNumber: string;
       holderName: string;
     };
   }
   
   /**
    * í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ì·¨ì†Œ ì‘ë‹µ (ì„ íƒì‚¬í•­)
    */
   export interface TossPaymentCancelResponse {
     payment_key: string;
     status: string;              // "CANCELED" ë˜ëŠ” "DONE" (ë¶€ë¶„ ì·¨ì†Œ ì‹œ)
     balance_amount: number;      // ì”ì•¡
     cancels: Array<{
       transactionKey: string;
       cancelAmount: number;
       cancelReason: string;
       cancelStatus: string;
       canceledAt: string;
     }>;
     receipt_url: string;
   }
   
   /**
    * ê²°ì œ ì—ëŸ¬ íƒ€ì… (ê¸°ì¡´ ìœ ì§€)
    */
   export interface PaymentError {
     status: number;
     message: string;
   }
   ```

2. API í•¨ìˆ˜ ìˆ˜ì •
   íŒŒì¼: components/timecapsule-create/components/step-payment/api/payment.ts
   
   [ì œê±°] ê¸°ì¡´ í•¨ìˆ˜
   ```typescript
   export const readyKakaoPay = async (...) => { ... };
   export const approveKakaoPay = async (...) => { ... };
   ```
   
   [ì¶”ê°€] í† ìŠ¤í˜ì´ë¨¼ì¸  í•¨ìˆ˜
   ```typescript
   import axios from 'axios';
   import { API_BASE_URL } from '@/commons/constants';
   import type {
     TossPaymentConfirmRequest,
     TossPaymentConfirmResponse,
     TossPaymentResponse,
     TossPaymentCancelResponse,
     PaymentError,
   } from './types/payment';
   
   // axios ì¸ìŠ¤í„´ìŠ¤ (ê¸°ì¡´ í”„ë¡œì íŠ¸ íŒ¨í„´ ì‚¬ìš©)
   const apiClient = axios.create({
     baseURL: API_BASE_URL,
     timeout: 10000,
   });
   
   /**
    * í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ìŠ¹ì¸
    * @param paymentKey ê²°ì œ í‚¤
    * @param orderId ì£¼ë¬¸ ID
    * @param amount ê²°ì œ ê¸ˆì•¡
    * @param accessToken JWT í† í°
    * @returns ê²°ì œ ìŠ¹ì¸ ê²°ê³¼
    */
   export const confirmTossPayment = async (
     paymentKey: string,
     orderId: string,
     amount: number,
     accessToken: string,
   ): Promise<TossPaymentConfirmResponse> => {
     try {
       const response = await apiClient.post(
         '/api/payments/toss/confirm',
         {
           paymentKey,
           orderId,
           amount,
         },
         {
           headers: {
             Authorization: `Bearer ${accessToken}`,
           },
         },
       );
       
       return response.data;
     } catch (error: any) {
       // ì—ëŸ¬ ë©”ì‹œì§€ ë§¤í•‘
       const status = error.response?.status || 0;
       let message = 'ê²°ì œ ìŠ¹ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤';
       
       if (status === 400) {
         const errorCode = error.response?.data?.code;
         if (errorCode === 'AMOUNT_MISMATCH') {
           message = 'ê²°ì œ ê¸ˆì•¡ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤';
         } else if (errorCode === 'ORDER_ALREADY_PAID') {
           message = 'ì´ë¯¸ ê²°ì œê°€ ì™„ë£Œëœ ì£¼ë¬¸ì…ë‹ˆë‹¤';
         } else {
           message = error.response?.data?.message || message;
         }
       } else if (status === 401) {
         message = 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤';
       } else if (status === 404) {
         const errorCode = error.response?.data?.code;
         if (errorCode === 'ORDER_NOT_FOUND') {
           message = 'ì£¼ë¬¸ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤';
         } else if (errorCode === 'PRODUCT_NOT_FOUND_OR_INVALID') {
           message = 'ìƒí’ˆ ì •ë³´ê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤';
         }
       } else if (status === 500) {
         const errorCode = error.response?.data?.code;
         if (errorCode === 'TOSS_SECRET_KEY_REQUIRED') {
           message = 'ê²°ì œ ì‹œìŠ¤í…œ ì„¤ì • ì˜¤ë¥˜ì…ë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•´ì£¼ì„¸ìš”';
         } else if (errorCode === 'TOSS_CONFIRM_FAILED') {
           message = 'ê²°ì œ ìŠ¹ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ê³ ê°ì„¼í„°ë¡œ ë¬¸ì˜í•´ì£¼ì„¸ìš”';
         } else {
           message = 'ì¼ì‹œì ì¸ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”';
         }
       } else if (!status) {
         message = 'ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”';
       }
       
       const paymentError: PaymentError = { status, message };
       throw paymentError;
     }
   };
   
   /**
    * í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ì¡°íšŒ (paymentKey) - ì„ íƒì‚¬í•­
    */
   export const getTossPaymentByKey = async (
     paymentKey: string,
     accessToken: string,
   ): Promise<TossPaymentResponse> => {
     const response = await apiClient.get(
       `/api/payments/toss/${paymentKey}`,
       {
         headers: {
           Authorization: `Bearer ${accessToken}`,
         },
       },
     );
     
     return response.data;
   };
   
   /**
    * í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ì¡°íšŒ (orderNo) - ì„ íƒì‚¬í•­
    */
   export const getTossPaymentByOrderNo = async (
     orderNo: string,
     accessToken: string,
   ): Promise<TossPaymentResponse> => {
     const response = await apiClient.get(
       `/api/payments/toss/orders/${orderNo}`,
       {
         headers: {
           Authorization: `Bearer ${accessToken}`,
         },
       },
     );
     
     return response.data;
   };
   
   /**
    * í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ì·¨ì†Œ - ì„ íƒì‚¬í•­
    * @param paymentKey ê²°ì œ í‚¤
    * @param cancelReason ì·¨ì†Œ ì‚¬ìœ 
    * @param cancelAmount ì·¨ì†Œ ê¸ˆì•¡ (ì„ íƒ, ì—†ìœ¼ë©´ ì „ì•¡ ì·¨ì†Œ)
    * @param accessToken JWT í† í°
    * @returns ê²°ì œ ì·¨ì†Œ ê²°ê³¼
    */
   export const cancelTossPayment = async (
     paymentKey: string,
     cancelReason: string,
     cancelAmount: number | undefined,
     accessToken: string,
   ): Promise<TossPaymentCancelResponse> => {
     try {
       const response = await apiClient.post(
         `/api/payments/toss/${paymentKey}/cancel`,
         {
           cancelReason,
           ...(cancelAmount !== undefined && { cancelAmount }),
         },
         {
           headers: {
             Authorization: `Bearer ${accessToken}`,
           },
         },
       );
       
       return response.data;
     } catch (error: any) {
       // ì—ëŸ¬ ë©”ì‹œì§€ ë§¤í•‘
       const status = error.response?.status || 0;
       let message = 'ê²°ì œ ì·¨ì†Œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤';
       
       if (status === 400) {
         const errorCode = error.response?.data?.code;
         if (errorCode === 'TOSS_SECRET_KEY_REQUIRED') {
           message = 'ê²°ì œ ì‹œìŠ¤í…œ ì„¤ì • ì˜¤ë¥˜ì…ë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•´ì£¼ì„¸ìš”';
         } else if (errorCode === 'TOSS_CANCEL_FAILED') {
           message = `ê²°ì œ ì·¨ì†Œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${error.response?.data?.message || ''}`;
         } else {
           message = error.response?.data?.message || message;
         }
       } else if (status === 401) {
         const errorCode = error.response?.data?.code;
         if (errorCode === 'ORDER_NOT_OWNED') {
           message = 'ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ê²°ì œëŠ” ì·¨ì†Œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤';
         } else {
           message = 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤';
         }
       } else if (status === 404) {
         message = 'ê²°ì œ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤';
       } else if (!status) {
         message = 'ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”';
       }
       
       const paymentError: PaymentError = { status, message };
       throw paymentError;
     }
   };
   ```

3. useTossPayment Hook êµ¬í˜„
   íŒŒì¼ëª… ë³€ê²½: useKakaoPayment.ts â†’ useTossPayment.ts
   íŒŒì¼: components/timecapsule-create/components/step-payment/hooks/useTossPayment.ts
   
   ```typescript
   import { useCallback, useState } from 'react';
   import TossPayments from '@tosspayments/payment-sdk-react-native';
   import { useAuth } from '@/commons/layout/provider/auth/auth.provider';
   import { confirmTossPayment } from '../api/payment';
   import type {
     TossPaymentConfirmResponse,
     PaymentError,
   } from '../api/types/payment';
   
   interface UseTossPaymentReturn {
     /** ë¡œë”© ìƒíƒœ */
     isLoading: boolean;
     /** ì—ëŸ¬ ì •ë³´ */
     error: PaymentError | null;
     /** í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ìš”ì²­ */
     requestPayment: (
       orderId: string,
       amount: number,
       orderName: string,
       customerName?: string,
     ) => Promise<void>;
     /** ê²°ì œ ìŠ¹ì¸ */
     confirmPayment: (
       paymentKey: string,
       orderId: string,
       amount: number,
     ) => Promise<TossPaymentConfirmResponse>;
     /** ì—ëŸ¬ í´ë¦¬ì–´ */
     clearError: () => void;
   }
   
   export const useTossPayment = (): UseTossPaymentReturn => {
     const { accessToken } = useAuth();
     const [isLoading, setIsLoading] = useState<boolean>(false);
     const [error, setError] = useState<PaymentError | null>(null);
     
     /**
      * í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ìš”ì²­
      */
     const requestPayment = useCallback(
       async (
         orderId: string,
         amount: number,
         orderName: string,
         customerName?: string,
       ): Promise<void> => {
         try {
           setIsLoading(true);
           setError(null);
           
           // í† ìŠ¤í˜ì´ë¨¼ì¸  í´ë¼ì´ì–¸íŠ¸ í‚¤ (í™˜ê²½ ë³€ìˆ˜)
           const clientKey = process.env.EXPO_PUBLIC_TOSS_CLIENT_KEY;
           
           if (!clientKey) {
             throw new Error('í† ìŠ¤í˜ì´ë¨¼ì¸  í´ë¼ì´ì–¸íŠ¸ í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤');
           }
           
           console.log('ğŸ’³ [í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ì‹œì‘]');
           console.log('  - ì£¼ë¬¸ ID:', orderId);
           console.log('  - ê¸ˆì•¡:', amount);
           console.log('  - ì£¼ë¬¸ëª…:', orderName);
           
           // í† ìŠ¤í˜ì´ë¨¼ì¸  SDK ì´ˆê¸°í™”
           const tossPayments = await TossPayments(clientKey);
           
           // ê²°ì œ ìš”ì²­
           await tossPayments.requestPayment('ì¹´ë“œ', {
             amount,
             orderId,
             orderName,
             customerName: customerName || 'ê³ ê°',
             successUrl: 'myapp://pay/toss/success',
             failUrl: 'myapp://pay/toss/fail',
           });
           
           console.log('âœ… [í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ í˜ì´ì§€ ì—´ë¦¼]');
         } catch (err) {
           console.error('âŒ [í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ì‹¤íŒ¨]', err);
           
           const paymentError: PaymentError = {
             status: 0,
             message: err instanceof Error ? err.message : 'ê²°ì œ í˜ì´ì§€ë¥¼ ì—´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤',
           };
           
           setError(paymentError);
           throw paymentError;
         } finally {
           setIsLoading(false);
         }
       },
       [],
     );
     
     /**
      * ê²°ì œ ìŠ¹ì¸
      */
     const confirmPayment = useCallback(
       async (
         paymentKey: string,
         orderId: string,
         amount: number,
       ): Promise<TossPaymentConfirmResponse> => {
         try {
           setIsLoading(true);
           setError(null);
           
           if (!accessToken) {
             throw new Error('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤');
           }
           
           console.log('ğŸ’³ [ê²°ì œ ìŠ¹ì¸ ì‹œì‘]');
           console.log('  - paymentKey:', paymentKey);
           console.log('  - orderId:', orderId);
           console.log('  - amount:', amount);
           
           const response = await confirmTossPayment(
             paymentKey,
             orderId,
             amount,
             accessToken,
           );
           
           console.log('âœ… [ê²°ì œ ìŠ¹ì¸ ì„±ê³µ]');
           console.log('  - ì£¼ë¬¸ë²ˆí˜¸:', response.order_id);
           console.log('  - ìƒíƒœ:', response.status);
           console.log('  - ê¸ˆì•¡:', response.amount);
           
           return response;
         } catch (err) {
           console.error('âŒ [ê²°ì œ ìŠ¹ì¸ ì‹¤íŒ¨]', err);
           
           const paymentError =
             err instanceof Error && 'status' in err
               ? (err as PaymentError)
               : {
                   status: 0,
                   message: err instanceof Error ? err.message : 'ê²°ì œ ìŠ¹ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤',
                 };
           
           setError(paymentError);
           throw paymentError;
         } finally {
           setIsLoading(false);
         }
       },
       [accessToken],
     );
     
     /**
      * ì—ëŸ¬ í´ë¦¬ì–´
      */
     const clearError = useCallback(() => {
       setError(null);
     }, []);
     
     return {
       isLoading,
       error,
       requestPayment,
       confirmPayment,
       clearError,
     };
   };
   ```

4. types.ts ìˆ˜ì •
   íŒŒì¼: components/timecapsule-create/components/step-payment/types.ts
   
   ```typescript
   // ê¸°ì¡´
   import type { KakaoPayApproveResponse } from './api/types/payment';
   
   export interface StepPaymentProps {
     formData: FormData;
     orderData: OrderData;
     onSubmit: (orderSummary: OrderSummary) => void;
     onBack: () => void;
     onPaymentSuccess?: (paymentData: KakaoPayApproveResponse) => void;
   }
   
   // ë³€ê²½
   import type { TossPaymentConfirmResponse } from './api/types/payment';
   
   export interface StepPaymentProps {
     formData: FormData;
     orderData: OrderData;
     onSubmit: (orderSummary: OrderSummary) => void;
     onBack: () => void;
     onPaymentSuccess?: (paymentData: TossPaymentConfirmResponse) => void;
   }
   ```

5. index.tsx ìˆ˜ì •
   íŒŒì¼: components/timecapsule-create/components/step-payment/index.tsx
   
   [ë³€ê²½ 1] Import ìˆ˜ì •
   ```typescript
   // ê¸°ì¡´
   import { useKakaoPayment } from './hooks/useKakaoPayment';
   
   // ë³€ê²½
   import { useTossPayment } from './hooks/useTossPayment';
   ```
   
   [ë³€ê²½ 2] TEXTS ìƒìˆ˜ ìˆ˜ì •
   ```typescript
   const TEXTS = {
     // ...
     footer: {
       submitButton: 'í† ìŠ¤í˜ì´ë¨¼ì¸ ë¡œ ê²°ì œí•˜ê¸°', // ê¸°ì¡´: 'ì¹´ì¹´ì˜¤í˜ì´ë¡œ ê²°ì œí•˜ê¸°'
     },
   };
   ```
   
   [ë³€ê²½ 3] Hook ì—°ê²°
   ```typescript
   // ê¸°ì¡´
   const { isLoading, error, readyPayment, approvePayment, openKakaoPayBrowser, clearError } =
     useKakaoPayment();
   
   // ë³€ê²½
   const { isLoading, error, requestPayment, confirmPayment, clearError } =
     useTossPayment();
   ```
   
   [ë³€ê²½ 4] ê²°ì œí•˜ê¸° ë²„íŠ¼ í•¸ë“¤ëŸ¬
   ```typescript
   // ê¸°ì¡´
   const handleSubmitPress = useCallback(async () => {
     if (!isPaymentEnabled) {
       Alert.alert('ì•Œë¦¼', TEXTS.alerts.agreementRequired);
       return;
     }
     
     try {
       const { redirect_url } = await readyPayment(orderData.order_id);
       await openKakaoPayBrowser(redirect_url);
     } catch (err) {
       Alert.alert('ê²°ì œ ì¤€ë¹„ ì‹¤íŒ¨', err.message);
     }
   }, [isPaymentEnabled, readyPayment, openKakaoPayBrowser, orderData.order_id]);
   
   // ë³€ê²½
   const handleSubmitPress = useCallback(async () => {
     if (!isPaymentEnabled) {
       Alert.alert('ì•Œë¦¼', TEXTS.alerts.agreementRequired);
       return;
     }
     
     try {
       await requestPayment(
         orderData.order_id,
         orderSummary.totalPrice,
         'íƒ€ì„ìº¡ìŠ ìƒì„±',
         formData.roomName,
       );
     } catch (err) {
       const errorMessage =
         err && typeof err === 'object' && 'message' in err
           ? (err as PaymentError).message
           : 'ê²°ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤';
       Alert.alert('ê²°ì œ ì‹¤íŒ¨', errorMessage);
     }
   }, [
     isPaymentEnabled,
     requestPayment,
     orderData.order_id,
     orderSummary.totalPrice,
     formData.roomName,
   ]);
   ```
   
   [ë³€ê²½ 5] ë”¥ë§í¬ ì²˜ë¦¬
   ```typescript
   // ê¸°ì¡´
   const handlePaymentApproval = useCallback(
     async (pgToken: string) => {
       try {
         const paymentData = await approvePayment(orderData.order_id, pgToken);
         
         openModal({
           width: 344,
           height: 'auto',
           closeOnBackdropPress: true,
           children: (
             <ConfirmModal type="PAYMENT_COMPLETE" onConfirm={handlePaymentCompleteConfirm} />
           ),
         });
         
         if (onPaymentSuccess) {
           onPaymentSuccess(paymentData);
         }
       } catch (err) {
         Alert.alert('ê²°ì œ ìŠ¹ì¸ ì‹¤íŒ¨', err.message);
       }
     },
     [approvePayment, orderData.order_id, openModal, handlePaymentCompleteConfirm, onPaymentSuccess],
   );
   
   useEffect(() => {
     const handleDeepLink = (event: { url: string }) => {
       const url = event.url;
       const urlObj = new URL(url);
       const pgToken = urlObj.searchParams.get('pg_token');
       const path = urlObj.pathname;
       
       if (pgToken && path.includes('/payment/success')) {
         handlePaymentApproval(pgToken);
       } else if (path.includes('/payment/cancel')) {
         Alert.alert('ê²°ì œ ì·¨ì†Œ', 'ê²°ì œê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');
       } else if (path.includes('/payment/fail')) {
         Alert.alert('ê²°ì œ ì‹¤íŒ¨', 'ê²°ì œ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
       }
     };
     
     const subscription = Linking.addEventListener('url', handleDeepLink);
     
     Linking.getInitialURL().then((url) => {
       if (url) {
         handleDeepLink({ url });
       }
     });
     
     return () => {
       subscription.remove();
     };
   }, [handlePaymentApproval]);
   
   // ë³€ê²½
   const handlePaymentSuccess = useCallback(
     async (paymentKey: string, orderId: string, amount: number) => {
       try {
         console.log('ğŸ’³ [ê²°ì œ ì„±ê³µ - ìŠ¹ì¸ ì‹œì‘]');
         console.log('  - paymentKey:', paymentKey);
         console.log('  - orderId:', orderId);
         console.log('  - amount:', amount);
         
         // ê²°ì œ ìŠ¹ì¸
         const paymentData = await confirmPayment(paymentKey, orderId, amount);
         
         console.log('âœ… [ê²°ì œ ìŠ¹ì¸ ì™„ë£Œ]');
         
         // ê²°ì œ ì™„ë£Œ ëª¨ë‹¬ í‘œì‹œ
         openModal({
           width: 344,
           height: 'auto',
           closeOnBackdropPress: true,
           children: (
             <ConfirmModal type="PAYMENT_COMPLETE" onConfirm={handlePaymentCompleteConfirm} />
           ),
         });
         
         // ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ë¡œ ê²°ì œ ì„±ê³µ ì´ë²¤íŠ¸ ì „ë‹¬
         if (onPaymentSuccess) {
           onPaymentSuccess(paymentData);
         }
       } catch (err) {
         const errorMessage =
           err && typeof err === 'object' && 'message' in err
             ? (err as PaymentError).message
             : 'ê²°ì œ ìŠ¹ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤';
         console.error('âŒ [ê²°ì œ ìŠ¹ì¸ ì‹¤íŒ¨]', errorMessage);
         Alert.alert('ê²°ì œ ìŠ¹ì¸ ì‹¤íŒ¨', errorMessage);
       }
     },
     [confirmPayment, openModal, handlePaymentCompleteConfirm, onPaymentSuccess],
   );
   
   useEffect(() => {
     const handleDeepLink = (event: { url: string }) => {
       const url = event.url;
       console.log('ğŸ”— [DeepLink] URL ìˆ˜ì‹ :', url);
       
       const urlObj = new URL(url);
       const path = urlObj.pathname;
       
       // í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ì„±ê³µ
       if (path.includes('/pay/toss/success')) {
         const paymentKey = urlObj.searchParams.get('paymentKey');
         const orderId = urlObj.searchParams.get('orderId');
         const amount = urlObj.searchParams.get('amount');
         
         console.log('âœ… [DeepLink] ê²°ì œ ì„±ê³µ');
         console.log('  - paymentKey:', paymentKey);
         console.log('  - orderId:', orderId);
         console.log('  - amount:', amount);
         
         if (paymentKey && orderId && amount) {
           handlePaymentSuccess(paymentKey, orderId, parseInt(amount, 10));
         } else {
           Alert.alert('ê²°ì œ ì˜¤ë¥˜', 'ê²°ì œ ì •ë³´ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
         }
       }
       // í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ì‹¤íŒ¨
       else if (path.includes('/pay/toss/fail')) {
         const code = urlObj.searchParams.get('code');
         const message = urlObj.searchParams.get('message');
         
         console.log('âŒ [DeepLink] ê²°ì œ ì‹¤íŒ¨');
         console.log('  - code:', code);
         console.log('  - message:', message);
         
         Alert.alert('ê²°ì œ ì‹¤íŒ¨', message || 'ê²°ì œ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
       }
     };
     
     const subscription = Linking.addEventListener('url', handleDeepLink);
     
     Linking.getInitialURL().then((url) => {
       if (url) {
         handleDeepLink({ url });
       }
     });
     
     return () => {
       subscription.remove();
     };
   }, [handlePaymentSuccess]);
   ```

==============================================

í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

1. .env íŒŒì¼ì— í† ìŠ¤í˜ì´ë¨¼ì¸  í´ë¼ì´ì–¸íŠ¸ í‚¤ ì¶”ê°€
   ```
   # ê°œë°œ í™˜ê²½ (í…ŒìŠ¤íŠ¸ í‚¤)
   EXPO_PUBLIC_TOSS_CLIENT_KEY=test_ck_xxxxxxxxxxxx
   
   # ìš´ì˜ í™˜ê²½ (ë¼ì´ë¸Œ í‚¤)
   # EXPO_PUBLIC_TOSS_CLIENT_KEY=live_ck_xxxxxxxxxxxx
   ```

2. app.jsonì— ë”¥ë§í¬ URL scheme í™•ì¸
   ```json
   {
     "expo": {
       "scheme": "myapp",
       "ios": {
         "bundleIdentifier": "com.yourapp.timecapsule"
       },
       "android": {
         "package": "com.yourapp.timecapsule"
       }
     }
   }
   ```

==============================================

êµ¬í˜„ ìˆœì„œ

1. íŒ¨í‚¤ì§€ ì„¤ì¹˜
   - npm install @tosspayments/payment-sdk-react-native

2. API Types íŒŒì¼ ìˆ˜ì •
   - ì¹´ì¹´ì˜¤í˜ì´ íƒ€ì… ì œê±°
   - í† ìŠ¤í˜ì´ë¨¼ì¸  íƒ€ì… ì¶”ê°€ (TossPaymentConfirmRequest, TossPaymentConfirmResponse)

3. API í•¨ìˆ˜ ìˆ˜ì •
   - readyKakaoPay, approveKakaoPay ì‚­ì œ
   - confirmTossPayment ì¶”ê°€
   - ì—ëŸ¬ ë©”ì‹œì§€ ë§¤í•‘ (AMOUNT_MISMATCH, ORDER_ALREADY_PAID ë“±)

4. Hook íŒŒì¼ëª… ë³€ê²½ ë° ìˆ˜ì •
   - useKakaoPayment.ts â†’ useTossPayment.ts
   - requestPayment, confirmPayment í•¨ìˆ˜ êµ¬í˜„

5. types.ts ìˆ˜ì •
   - KakaoPayApproveResponse â†’ TossPaymentConfirmResponse

6. index.tsx ìˆ˜ì •
   - useKakaoPayment â†’ useTossPayment
   - TEXTS ìƒìˆ˜ ìˆ˜ì • ("í† ìŠ¤í˜ì´ë¨¼ì¸ ë¡œ ê²°ì œí•˜ê¸°")
   - handleSubmitPress ë¡œì§ ë³€ê²½ (Toss SDK í˜¸ì¶œ)
   - ë”¥ë§í¬ ì²˜ë¦¬ ìˆ˜ì • (paymentKey, orderId, amount)

7. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
   - .envì— EXPO_PUBLIC_TOSS_CLIENT_KEY ì¶”ê°€

8. í…ŒìŠ¤íŠ¸
   - ê²°ì œ ìš”ì²­ (requestPayment)
   - ê²°ì œ ì„±ê³µ ì‹œ ë”¥ë§í¬ ì²˜ë¦¬
   - ê²°ì œ ì‹¤íŒ¨ ì‹œ ì—ëŸ¬ ë©”ì‹œì§€
   - ê²°ì œ ìŠ¹ì¸ API í˜¸ì¶œ (confirmPayment)

9. ì²´í¬ë¦¬ìŠ¤íŠ¸ ì‘ì„±

==============================================

ì£¼ì˜ì‚¬í•­

1. ê¸°ì¡´ ì½”ë“œ ìœ ì§€
   - index.tsxì˜ ê¸°ë³¸ UI êµ¬ì¡°ëŠ” ìµœëŒ€í•œ ìœ ì§€
   - ê¸°ì¡´ hooks (usePaymentValidation, useOrderSummary) ìœ ì§€
   - styles.tsëŠ” ìˆ˜ì •í•˜ì§€ ì•ŠìŒ

2. API í´ë¼ì´ì–¸íŠ¸ í‘œì¤€í™”
   - axios ì‚¬ìš© (ê¸°ì¡´ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš© ì¤‘)
   - JWT í† í° ìˆ˜ë™ í¬í•¨ (Authorization í—¤ë”)
   - ì—ëŸ¬ ì²˜ë¦¬ í‘œì¤€í™” (axios error.response íŒ¨í„´)
   - íƒ€ì… ì•ˆì •ì„± í™•ë³´

3. ê²°ì œ í”Œë¡œìš° ì•ˆì •ì„±
   - ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ ì¬ì‹œë„ ê°€ëŠ¥
   - ê²°ì œ ì·¨ì†Œ ì‹œ ì¬ì‹œë„ ê°€ëŠ¥
   - ê²°ì œ ìŠ¹ì¸ ì‹¤íŒ¨ ì‹œ ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€
   - ê¸ˆì•¡ ë¶ˆì¼ì¹˜ ì—ëŸ¬ ëª…í™•íˆ ì²˜ë¦¬

4. ëª¨ë°”ì¼ í™˜ê²½ ê³ ë ¤
   - Toss Payments SDK ì‚¬ìš© (React Native ì „ìš©)
   - ë”¥ë§í¬ ì²˜ë¦¬ (successUrl, failUrl)
   - ì•± ë³µê·€ ì‹œ íŒŒë¼ë¯¸í„° ì¶”ì¶œ

5. ì‚¬ìš©ì ê²½í—˜
   - ë¡œë”© ì¤‘ ëª…í™•í•œ í”¼ë“œë°±
   - ì—ëŸ¬ ì‹œ ëª…í™•í•œ ì•ˆë‚´ ë©”ì‹œì§€
   - ê²°ì œ ì™„ë£Œ ì‹œ ì„±ê³µ í”¼ë“œë°±

6. ë³´ì•ˆ
   - JWT í† í°ì€ Authorization í—¤ë”ë¡œ ì „ë‹¬
   - paymentKeyëŠ” URL íŒŒë¼ë¯¸í„°ë¡œë§Œ ì „ë‹¬ (ì €ì¥í•˜ì§€ ì•ŠìŒ)
   - ë¯¼ê°í•œ ì •ë³´ ë¡œê·¸ ì¶œë ¥ ê¸ˆì§€

==============================================

í† ìŠ¤í˜ì´ë¨¼ì¸  SDK ì‚¬ìš© ì˜ˆì‹œ

```typescript
import TossPayments from '@tosspayments/payment-sdk-react-native';

// SDK ì´ˆê¸°í™”
const clientKey = process.env.EXPO_PUBLIC_TOSS_CLIENT_KEY;
const tossPayments = await TossPayments(clientKey);

// ê²°ì œ ìš”ì²­
await tossPayments.requestPayment('ì¹´ë“œ', {
  amount: 10000,
  orderId: 'order-uuid',
  orderName: 'íƒ€ì„ìº¡ìŠ ìƒì„±',
  customerName: 'í™ê¸¸ë™',
  successUrl: 'myapp://pay/toss/success',
  failUrl: 'myapp://pay/toss/fail',
});
```

==============================================

ìµœì¢…ê²€í†  ì²´í¬ë¦¬ìŠ¤íŠ¸

íŒ¨í‚¤ì§€ ë° í™˜ê²½ ì„¤ì •:
- [ ] @tosspayments/payment-sdk-react-native íŒ¨í‚¤ì§€ ì„¤ì¹˜ ì™„ë£Œ
- [ ] .envì— EXPO_PUBLIC_TOSS_CLIENT_KEY ì¶”ê°€ ì™„ë£Œ
- [ ] app.json URL scheme í™•ì¸ ì™„ë£Œ

API ë ˆì´ì–´:
- [ ] API Types íŒŒì¼ ìˆ˜ì • ì™„ë£Œ (ì¹´ì¹´ì˜¤í˜ì´ íƒ€ì… ì œê±°, í† ìŠ¤í˜ì´ë¨¼ì¸  íƒ€ì… ì¶”ê°€)
- [ ] confirmTossPayment API í•¨ìˆ˜ êµ¬í˜„ ì™„ë£Œ
- [ ] ì—ëŸ¬ ë©”ì‹œì§€ ë§¤í•‘ êµ¬í˜„ ì™„ë£Œ (AMOUNT_MISMATCH, ORDER_ALREADY_PAID ë“±)
- [ ] getTossPaymentByKey, getTossPaymentByOrderNo í•¨ìˆ˜ êµ¬í˜„ ì™„ë£Œ (ì„ íƒì‚¬í•­)

Hook ë ˆì´ì–´:
- [ ] useKakaoPayment.ts íŒŒì¼ ì‚­ì œ ì™„ë£Œ
- [ ] useTossPayment.ts Hook êµ¬í˜„ ì™„ë£Œ
- [ ] requestPayment í•¨ìˆ˜ êµ¬í˜„ ì™„ë£Œ
- [ ] confirmPayment í•¨ìˆ˜ êµ¬í˜„ ì™„ë£Œ

ì»´í¬ë„ŒíŠ¸ ë ˆì´ì–´:
- [ ] types.tsì— TossPaymentConfirmResponse ì ìš© ì™„ë£Œ
- [ ] index.tsx import ë³€ê²½ ì™„ë£Œ (useTossPayment)
- [ ] index.tsx TEXTS ìƒìˆ˜ ìˆ˜ì • ì™„ë£Œ ("í† ìŠ¤í˜ì´ë¨¼ì¸ ë¡œ ê²°ì œí•˜ê¸°")
- [ ] handleSubmitPress ë¡œì§ ë³€ê²½ ì™„ë£Œ (Toss SDK í˜¸ì¶œ)
- [ ] handlePaymentSuccess í•¨ìˆ˜ êµ¬í˜„ ì™„ë£Œ (ê²°ì œ ìŠ¹ì¸)
- [ ] ë”¥ë§í¬ ë¦¬ìŠ¤ë„ˆ ìˆ˜ì • ì™„ë£Œ (paymentKey, orderId, amount)

UI ë° UX:
- [ ] ë¡œë”© ìƒíƒœ UI í™•ì¸ ì™„ë£Œ
- [ ] ì—ëŸ¬ ì²˜ë¦¬ ë° Alert ë©”ì‹œì§€ êµ¬í˜„ ì™„ë£Œ
- [ ] ê²°ì œ ì™„ë£Œ ëª¨ë‹¬ í‘œì‹œ í™•ì¸ ì™„ë£Œ
- [ ] ê¸°ì¡´ UI êµ¬ì¡° ìœ ì§€ í™•ì¸

ì½”ë“œ í’ˆì§ˆ:
- [ ] TypeScript íƒ€ì… ì—ëŸ¬ 0ê±´
- [ ] JWT í† í° Authorization í—¤ë” í¬í•¨ í™•ì¸
- [ ] ë¯¼ê°í•œ ì •ë³´ ë¡œê·¸ ì¶œë ¥ 0ê±´
- [ ] ì½”ë“œ ê°€ë…ì„± ë° ìœ ì§€ë³´ìˆ˜ì„± í™•ë³´

ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸:
- [ ] ê²°ì œ ìš”ì²­ í…ŒìŠ¤íŠ¸ ì™„ë£Œ (Toss SDK í˜¸ì¶œ)
- [ ] ê²°ì œ ì„±ê³µ ì‹œ ë”¥ë§í¬ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸ ì™„ë£Œ
- [ ] ê²°ì œ ì‹¤íŒ¨ ì‹œ ì—ëŸ¬ ë©”ì‹œì§€ í…ŒìŠ¤íŠ¸ ì™„ë£Œ
- [ ] ê²°ì œ ìŠ¹ì¸ API í˜¸ì¶œ í…ŒìŠ¤íŠ¸ ì™„ë£Œ
- [ ] ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ ì¬ì‹œë„ ê°€ëŠ¥ í™•ì¸
- [ ] ê²°ì œ ì·¨ì†Œ ì‹œ ì¬ì‹œë„ ê°€ëŠ¥ í™•ì¸

==============================================

ì°¸ê³ ì‚¬í•­

1) ë°±ì—”ë“œ API ì°¨ì´ì 
   - ì¹´ì¹´ì˜¤í˜ì´: ready â†’ redirect â†’ approve (3ë‹¨ê³„)
   - í† ìŠ¤í˜ì´ë¨¼ì¸ : SDK í˜¸ì¶œ â†’ successUrl ë¦¬ë‹¤ì´ë ‰íŠ¸ â†’ confirm (2ë‹¨ê³„)
   - í† ìŠ¤í˜ì´ë¨¼ì¸ ëŠ” ê²°ì œ ì¤€ë¹„ API(/ready)ê°€ ì—†ìœ¼ë©°, SDKê°€ ì§ì ‘ í† ìŠ¤ ì„œë²„ì™€ í†µì‹ 
   - í”„ë¡ íŠ¸ì—”ë“œëŠ” ê²°ì œ ì™„ë£Œ í›„ /confirm APIë§Œ í˜¸ì¶œ

2) ë¦¬ë‹¤ì´ë ‰íŠ¸ URL ê´€ë¦¬
   - ì¹´ì¹´ì˜¤í˜ì´: ë°±ì—”ë“œê°€ redirect_url ë°˜í™˜
   - í† ìŠ¤í˜ì´ë¨¼ì¸ : í”„ë¡ íŠ¸ì—”ë“œê°€ successUrl/failUrl ì„¤ì •
   - ë”¥ë§í¬ ì‚¬ìš©: myapp://pay/toss/success

3) íŒŒë¼ë¯¸í„° ì°¨ì´
   - ì¹´ì¹´ì˜¤í˜ì´: pg_token (ìŠ¹ì¸ìš© í† í°)
   - í† ìŠ¤í˜ì´ë¨¼ì¸ : paymentKey, orderId, amount (3ê°œ íŒŒë¼ë¯¸í„°)

4) í† ìŠ¤í˜ì´ë¨¼ì¸  ê³µì‹ ë¬¸ì„œ
   - https://docs.tosspayments.com/
   - React Native ì—°ë™ ê°€ì´ë“œ ì°¸ê³ 

5) ë”¥ë§í¬ ì²˜ë¦¬
   - ì„±ê³µ: myapp://pay/toss/success?paymentKey={key}&orderId={id}&amount={amount}
   - ì‹¤íŒ¨: myapp://pay/toss/fail?code={code}&message={message}

==============================================
